<app-page-content>
  <ng-container header>
    {{ 'user.edit.pageTitle' | translate }} <i>{{ user?.username }}</i>
  </ng-container>
  <ng-container actions>
    <button mat-raised-button color="warn" *ngIf="!existAdmin || isAdmin" [disabled]="inRequest" (click)="appointAdmin()">{{ (isAdmin ? 'user.edit.fireAdminBtn' : 'user.edit.appointAdminBtn') | translate }}</button>
  </ng-container>
  <ng-container content>

    <div class="wrapper">
      <section class="info-table-block">
        <div class="item">
          <p class="title">{{ 'user.info.id' | translate }}</p>
          <p class="value">{{ user?.id }}</p>
        </div>
        <div class="item">
          <p class="title">{{ 'user.info.username' | translate }}</p>
          <p class="value">{{ user?.username }}</p>
        </div>
        <div class="item">
          <p class="title">{{ 'user.info.name' | translate }}</p>
          <p class="value">{{ (user?.firstName || '') + ' ' + (user?.lastName || '') }}</p>
        </div>
        <div class="item">
          <p class="title">{{ 'user.info.operationsCount' | translate }}</p>
          <p class="value"><a [routerLink]="['/operations']" [queryParams]="{ user: user?.telegramUserId }">{{ user?.operationsCount }}</a></p>
        </div>
        <div class="item">
          <p class="title">{{ 'user.info.operationsSum' | translate }}</p>
          <p class="value">{{ user?.operationsSum }}</p>
        </div>
        <div class="item">
          <p class="title">{{ 'user.info.refCount' | translate }}</p>
          <p class="value">{{ user?.refCount }}</p>
        </div>
        <div class="item">
          <p class="title">{{ 'user.info.refActiveCount' | translate }}</p>
          <p class="value">{{ user?.refActiveCount }}</p>
        </div>
        <div class="item">
          <p class="title">{{ 'user.info.refOperationsCount' | translate }}</p>
          <p class="value">{{ user?.refOperationsCount }}</p>
        </div>
        <div class="item">
          <p class="title">{{ 'user.info.refOperationsSum' | translate }}</p>
          <p class="value">{{ user?.refOperationsSum }}</p>
        </div>
      </section>
      <div class="edit-info-block">
        <form [formGroup]="form" (ngSubmit)="save()" class="form">

          <div class="form-group">
            <mat-form-field appearance="fill">
              <mat-label>{{ 'user.edit.input.discount' | translate }}</mat-label>
              <input formControlName="discount" type="number" min="0" max="100" step="0.5" matInput>
              <mat-error><app-input-error name='discount' [errors]="errors"></app-input-error></mat-error>
            </mat-form-field>
          </div>

          <div class="form-group">
            <mat-form-field appearance="fill">
              <mat-label>{{ 'user.edit.input.comment' | translate }}</mat-label>
              <textarea formControlName="comment" matInput></textarea>
              <mat-error><app-input-error name='comment' [errors]="errors"></app-input-error></mat-error>
            </mat-form-field>
          </div>

          <div class="form-group">
            <mat-slide-toggle labelPosition="before" color="primary" formControlName="ban">
              <mat-label>{{ 'user.edit.input.ban' | translate }}</mat-label>
            </mat-slide-toggle>
          </div>

          <button mat-raised-button color="primary" [disabled]="form.invalid || inRequest">{{ 'user.edit.saveBtn' | translate }}</button>

        </form>
      </div>
    </div>

  </ng-container>
</app-page-content>
