(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{vloQ:function(t,e,i){"use strict";i.r(e),i.d(e,"SettingsCommissionModule",function(){return j});var s=i("ofXK"),n=i("3Pt+"),o=i("bTqV"),r=i("kmnG"),a=i("qFsG"),c=i("NFeN"),m=i("sYmb"),b=i("ir1t"),l=i("+dTB"),p=i("ULOc"),d=i("4evo"),u=i("tyNb"),g=i("5+tZ"),h=i("1G5W"),f=i("XNiG"),D=i("LRne"),v=i("i/bw"),T=i("fXoL"),y=i("FwLO"),R=i("Pfez"),U=i("Kbm1");let I=(()=>{class t{constructor(t,e,i,s){this.router=t,this.route=e,this.settingApiService=i,this.uiFacade=s,this.errors={},this.destroy$=new f.a,this.form=new n.f({from:new n.d("",[n.r.required,n.r.min(0)]),to:new n.d("",[n.r.required,n.r.min(0)]),percent:new n.d("",[n.r.required,n.r.min(0)])})}ngOnInit(){this.inRequest=!0,this.route.paramMap.pipe(Object(g.a)(t=>{const e=+t.get("id");return e?this.settingApiService.getCommission(e):Object(D.a)({})}),Object(h.a)(this.destroy$)).subscribe(t=>{this.inRequest=!1,this.commission=t,this.form.patchValue({from:t.from,to:t.to,percent:t.percent})},t=>this.showError(t))}save(){const t=this.form.get("from").value,e=this.form.get("to").value,i=this.form.get("percent").value,s=Object.assign(Object.assign({},this.commission),{from:t,to:e,percent:i});this.commission.id?this.updateRequisite(s):this.addRequisite(s)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}updateRequisite(t){this.inRequest=!0,this.settingApiService.updateCommission(t).subscribe(()=>this.router.navigateByUrl("/settings/commissions"),t=>this.showError(t))}addRequisite(t){this.inRequest=!0,this.settingApiService.addCommission(t).subscribe(()=>this.router.navigateByUrl("/settings/commissions"),t=>this.showError(t))}showError(t){var e;this.inRequest=!1,this.errors=(null==t?void 0:t.errors)||{};for(const i of Object.keys(this.errors))null===(e=this.form.get(i))||void 0===e||e.setErrors({valid:!1});this.uiFacade.addErrorNotification(t.message)}}return t.\u0275fac=function(e){return new(e||t)(T.Ob(u.f),T.Ob(u.a),T.Ob(y.e),T.Ob(v.f))},t.\u0275cmp=T.Ib({type:t,selectors:[["app-settings-commission-edit"]],decls:34,vars:20,consts:[["header",""],["content",""],[1,"form",3,"formGroup","ngSubmit"],[1,"form-group"],["appearance","fill"],["formControlName","from","type","number","min","0","step","0.0001","matInput",""],["name","from",3,"errors"],["formControlName","to","type","number","min","0","step","0.0015","matInput",""],["name","to",3,"errors"],["formControlName","percent","type","number","min","0","step","0.1","matInput",""],["name","percent",3,"errors"],["mat-raised-button","","color","primary",3,"disabled"]],template:function(t,e){1&t&&(T.Ub(0,"app-page-content"),T.Sb(1,0),T.Dc(2),T.gc(3,"translate"),T.Rb(),T.Sb(4,1),T.Ub(5,"form",2),T.bc("ngSubmit",function(){return e.save()}),T.Ub(6,"div",3),T.Ub(7,"mat-form-field",4),T.Ub(8,"mat-label"),T.Dc(9),T.gc(10,"translate"),T.Tb(),T.Pb(11,"input",5),T.Ub(12,"mat-error"),T.Pb(13,"app-input-error",6),T.Tb(),T.Tb(),T.Tb(),T.Ub(14,"div",3),T.Ub(15,"mat-form-field",4),T.Ub(16,"mat-label"),T.Dc(17),T.gc(18,"translate"),T.Tb(),T.Pb(19,"input",7),T.Ub(20,"mat-error"),T.Pb(21,"app-input-error",8),T.Tb(),T.Tb(),T.Tb(),T.Ub(22,"div",3),T.Ub(23,"mat-form-field",4),T.Ub(24,"mat-label"),T.Dc(25),T.gc(26,"translate"),T.Tb(),T.Pb(27,"input",9),T.Ub(28,"mat-error"),T.Pb(29,"app-input-error",10),T.Tb(),T.Tb(),T.Tb(),T.Ub(30,"div",3),T.Ub(31,"button",11),T.Dc(32),T.gc(33,"translate"),T.Tb(),T.Tb(),T.Tb(),T.Rb(),T.Tb()),2&t&&(T.Db(2),T.Fc(" ",T.hc(3,10,null!=e.commission&&e.commission.id?"settings.commissions.edit.pageTitle":"settings.commissions.new.pageTitle")," "),T.Db(3),T.lc("formGroup",e.form),T.Db(4),T.Ec(T.hc(10,12,"settings.commissions.edit.input.from")),T.Db(4),T.lc("errors",e.errors),T.Db(4),T.Ec(T.hc(18,14,"settings.commissions.edit.input.to")),T.Db(4),T.lc("errors",e.errors),T.Db(4),T.Ec(T.hc(26,16,"settings.commissions.edit.input.percent")),T.Db(4),T.lc("errors",e.errors),T.Db(2),T.lc("disabled",e.form.invalid||e.inRequest),T.Db(1),T.Ec(T.hc(33,18,"settings.commissions.edit.saveBtn")))},directives:[R.a,n.s,n.m,n.g,r.c,r.f,n.c,n.p,a.b,n.l,n.e,r.b,U.a,o.b],pipes:[m.c],styles:[".form[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);grid-column-gap:1.5rem}"]}),t})();var E=i("nYR2");const O=function(t){return["/settings/commissions",t,"edit"]};let S=(()=>{class t{constructor(t,e,i){this.route=t,this.settingApiService=e,this.uiFacade=i,this.destroy$=new f.a}ngOnInit(){this.route.paramMap.pipe(Object(g.a)(t=>this.settingApiService.getCommission(+t.get("id"))),Object(E.a)(()=>this.inRequest=!1),Object(h.a)(this.destroy$)).subscribe(t=>{this.commission=t},t=>{this.uiFacade.addErrorNotification(t.message)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(T.Ob(u.a),T.Ob(y.e),T.Ob(v.f))},t.\u0275cmp=T.Ib({type:t,selectors:[["app-settings-commission-info"]],decls:31,vars:21,consts:[["header",""],["actions",""],["mat-raised-button","","color","primary",3,"routerLink"],["content",""],[1,"info-table-block"],[1,"item"],[1,"title"],[1,"value"]],template:function(t,e){1&t&&(T.Ub(0,"app-page-content"),T.Sb(1,0),T.Dc(2),T.gc(3,"translate"),T.Rb(),T.Sb(4,1),T.Ub(5,"a",2),T.Ub(6,"mat-icon"),T.Dc(7,"edit"),T.Tb(),T.Ub(8,"span"),T.Dc(9),T.gc(10,"translate"),T.Tb(),T.Tb(),T.Rb(),T.Sb(11,3),T.Ub(12,"section",4),T.Ub(13,"div",5),T.Ub(14,"p",6),T.Dc(15),T.gc(16,"translate"),T.Tb(),T.Ub(17,"p",7),T.Dc(18),T.Tb(),T.Tb(),T.Ub(19,"div",5),T.Ub(20,"p",6),T.Dc(21),T.gc(22,"translate"),T.Tb(),T.Ub(23,"p",7),T.Dc(24),T.Tb(),T.Tb(),T.Ub(25,"div",5),T.Ub(26,"p",6),T.Dc(27),T.gc(28,"translate"),T.Tb(),T.Ub(29,"p",7),T.Dc(30),T.Tb(),T.Tb(),T.Tb(),T.Rb(),T.Tb()),2&t&&(T.Db(2),T.Fc(" ",T.hc(3,9,"settings.commissions.info.pageTitle")," "),T.Db(3),T.lc("routerLink",T.nc(19,O,null==e.commission?null:e.commission.id)),T.Db(4),T.Ec(T.hc(10,11,"settings.commissions.info.editBtn")),T.Db(6),T.Ec(T.hc(16,13,"settings.commissions.edit.input.from")),T.Db(3),T.Ec(null==e.commission?null:e.commission.from),T.Db(3),T.Ec(T.hc(22,15,"settings.commissions.edit.input.to")),T.Db(3),T.Ec(null==e.commission?null:e.commission.to),T.Db(3),T.Ec(T.hc(28,17,"settings.commissions.edit.input.percent")),T.Db(3),T.Ec(null==e.commission?null:e.commission.percent))},directives:[R.a,o.a,u.h,c.a],pipes:[m.c],encapsulation:2}),t})();var w=i("zp1y"),N=i("pLZG"),F=i("vkgz"),q=i("sKXY");const A=[{name:"from",nameI18n:"settings.commissions.table.from",type:q.g.STRING,sort:!0,allowedForRoles:[v.d.SUPER_ADMIN,v.d.ADMIN]},{name:"to",nameI18n:"settings.commissions.table.to",sort:!0,type:q.g.STRING,allowedForRoles:[v.d.SUPER_ADMIN,v.d.ADMIN]},{name:"percent",nameI18n:"settings.commissions.table.percent",type:q.g.STRING,sort:!0,allowedForRoles:[v.d.SUPER_ADMIN,v.d.ADMIN]},{name:"info",nameI18n:"table.action.info",type:q.g.STRING,actionData:{link:t=>`/settings/commissions/${null==t?void 0:t.id}/info`,actionType:q.f.LINK,eventType:q.e.INFO},allowedForRoles:[v.d.SUPER_ADMIN,v.d.ADMIN]},{name:"edit",nameI18n:"table.action.edit",type:q.g.STRING,actionData:{link:t=>`/settings/commissions/${null==t?void 0:t.id}/edit`,actionType:q.f.LINK,eventType:q.e.EDIT},allowedForRoles:[v.d.SUPER_ADMIN,v.d.ADMIN]},{name:"delete",nameI18n:"table.action.delete",type:q.g.STRING,actionData:{actionType:q.f.EVENT,eventType:q.e.DELETE},allowedForRoles:[v.d.SUPER_ADMIN,v.d.ADMIN]}];var C=i("7FcC");const M=[{path:"",component:(()=>{class t{constructor(t,e,i,s){this.adminFacade=t,this.uiFacade=e,this.confirmModalService=i,this.settingApiService=s,this.commissions=[],this.tableColumns=A,this.destroy$=new f.a}ngOnInit(){this.initFilterFields()}getSettingCommissionList(t=this.requestApiQuery){this.requestApiQuery=t,this.inRequest=!0,this.settingApiService.getCommissionList(t).pipe(Object(w.a)(this.adminFacade.admin$),Object(E.a)(()=>this.inRequest=!1),Object(h.a)(this.destroy$)).subscribe(([t,e])=>{this.commissions=t.data,this.paginator={length:t.total,page:t.currentPage,pageSize:t.pageSize}},t=>{this.uiFacade.addErrorNotification(t.message)})}setEventData(t){t.event===q.e.DELETE&&this.deleteCommission(t.data)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}deleteCommission(t){this.confirmModalService.openDialog({titleI18n:"confirm.deleteModal.title",titleKeyI18n:"",messageI18n:"confirm.deleteModal.message",messageKeyI18n:`${t.from} - ${t.to} : ${t.percent} %`,confirmBtn:!0,cancelBtn:!0}).pipe(Object(N.a)(t=>t),Object(F.a)(()=>this.inRequest=!0),Object(g.a)(()=>this.settingApiService.deleteCommission(t.id)),Object(E.a)(()=>this.inRequest=!1),Object(h.a)(this.destroy$)).subscribe(()=>{this.commissions=this.commissions.filter(e=>e.id!==t.id),this.getSettingCommissionList()},t=>{this.uiFacade.addErrorNotification(t.message)})}initFilterFields(){this.filterFields=[]}}return t.\u0275fac=function(e){return new(e||t)(T.Ob(v.a),T.Ob(v.f),T.Ob(l.b),T.Ob(y.e))},t.\u0275cmp=T.Ib({type:t,selectors:[["app-settings-commissions"]],decls:11,vars:11,consts:[[3,"tableColumns","inRequest","items","filterFields","paginator","getList","eventData"],["table-title",""],["table-actions",""],["mat-raised-button","","color","primary","disableRipple","true","routerLink","/settings/commissions/new",1,"nav-link"]],template:function(t,e){1&t&&(T.Ub(0,"app-page-content-table",0),T.bc("getList",function(t){return e.getSettingCommissionList(t)})("eventData",function(t){return e.setEventData(t)}),T.Sb(1,1),T.Dc(2),T.gc(3,"translate"),T.Rb(),T.Sb(4,2),T.Ub(5,"a",3),T.Ub(6,"mat-icon"),T.Dc(7,"add"),T.Tb(),T.Ub(8,"span"),T.Dc(9),T.gc(10,"translate"),T.Tb(),T.Tb(),T.Rb(),T.Tb()),2&t&&(T.lc("tableColumns",e.tableColumns)("inRequest",e.inRequest)("items",e.commissions)("filterFields",e.filterFields)("paginator",e.paginator),T.Db(2),T.Fc(" ",T.hc(3,7,"settings.commissions.tableHeader.title")," "),T.Db(7),T.Ec(T.hc(10,9,"settings.commissions.tableHeader.addBtn")))},directives:[C.a,o.a,u.h,c.a],pipes:[m.c],encapsulation:2}),t})()},{path:"new",component:I},{path:":id/edit",component:I},{path:":id/info",component:S}];let L=(()=>{class t{}return t.\u0275mod=T.Mb({type:t}),t.\u0275inj=T.Lb({factory:function(e){return new(e||t)},imports:[[u.i.forChild(M)],u.i]}),t})(),j=(()=>{class t{}return t.\u0275mod=T.Mb({type:t}),t.\u0275inj=T.Lb({factory:function(e){return new(e||t)},imports:[[s.c,c.b,a.c,o.c,r.e,m.b,n.q,b.a,l.a,p.a,d.a,L]]}),t})()}}]);