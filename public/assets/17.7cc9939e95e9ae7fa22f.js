(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{EbGA:function(e,t,s){"use strict";s.r(t),s.d(t,"SettingsMessagesModule",function(){return B});var i=s("ofXK"),a=s("3Pt+"),n=s("bTqV"),r=s("kmnG"),c=s("NFeN"),o=s("qFsG"),l=s("sYmb"),g=s("+dTB"),b=s("xoVn"),d=s("ULOc"),m=s("4evo"),p=s("tyNb"),u=s("yK//"),h=s("5+tZ"),f=s("nYR2"),v=s("1G5W"),T=s("XNiG"),y=s("LRne"),D=s("i/bw"),I=s("fXoL"),O=s("FwLO"),S=s("Pfez"),A=s("KVI4");let M=(()=>{class e{constructor(e,t,s,i){this.router=e,this.route=t,this.uiFacade=s,this.settingApiService=i,this.destroy$=new T.a,this.form=new a.f({title:new a.d(""),slug:new a.d(""),description:new a.d(""),text:new a.d("")})}ngOnInit(){this.route.paramMap.pipe(Object(h.a)(e=>{const t=+e.get("id");return t?this.settingApiService.getMessageTemplate(t):Object(y.a)({})}),Object(f.a)(()=>this.inRequest=!1),Object(v.a)(this.destroy$)).subscribe(e=>{this.message=e,this.form.patchValue({title:e.title,slug:e.slug,description:e.description,text:e.text})},e=>this.uiFacade.addErrorNotification(e.message))}save(){const e=this.form.get("title").value,t=this.form.get("slug").value,s=this.form.get("description").value,i=this.form.get("text").value,a=Object.assign(Object.assign({},this.message),{title:e,slug:t,description:s,text:i});this.message.id?this.updateMessageTemplate(a):this.addMessageTemplate(a)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}addMessageTemplate(e){this.settingApiService.addMessageTemplate(e).subscribe(e=>{this.router.navigateByUrl("/settings/messages"),this.uiFacade.addInfoNotification(e.message)},e=>this.uiFacade.addErrorNotification(e.message))}updateMessageTemplate(e){this.settingApiService.updateMessageTemplate(e).subscribe(e=>{this.router.navigateByUrl("/settings/messages"),this.uiFacade.addInfoNotification(e.message)},e=>this.uiFacade.addErrorNotification(e.message))}}return e.\u0275fac=function(t){return new(t||e)(I.Ob(p.f),I.Ob(p.a),I.Ob(D.f),I.Ob(O.e))},e.\u0275cmp=I.Ib({type:e,selectors:[["app-setting-message-template-edit"]],decls:32,vars:22,consts:[["header",""],["content",""],[1,"form",3,"formGroup","ngSubmit"],[1,"form-group"],["appearance","fill"],["formControlName","title","type","text","matInput",""],["formControlName","slug","type","text","matInput",""],["formControlName","description","matInput",""],["formControlName","text",3,"label","height"],["mat-raised-button","","color","primary",3,"disabled"]],template:function(e,t){1&e&&(I.Ub(0,"app-page-content"),I.Sb(1,0),I.Ac(2),I.gc(3,"translate"),I.Ub(4,"i"),I.Ac(5),I.Tb(),I.Rb(),I.Sb(6,1),I.Ub(7,"form",2),I.bc("ngSubmit",function(){return t.save()}),I.Ub(8,"div",3),I.Ub(9,"mat-form-field",4),I.Ub(10,"mat-label"),I.Ac(11),I.gc(12,"translate"),I.Tb(),I.Pb(13,"input",5),I.Tb(),I.Tb(),I.Ub(14,"div",3),I.Ub(15,"mat-form-field",4),I.Ub(16,"mat-label"),I.Ac(17),I.gc(18,"translate"),I.Tb(),I.Pb(19,"input",6),I.Tb(),I.Tb(),I.Ub(20,"div",3),I.Ub(21,"mat-form-field",4),I.Ub(22,"mat-label"),I.Ac(23),I.gc(24,"translate"),I.Tb(),I.Pb(25,"textarea",7),I.Tb(),I.Tb(),I.Ub(26,"div",3),I.Pb(27,"app-format-editor",8),I.gc(28,"translate"),I.Tb(),I.Ub(29,"button",9),I.Ac(30),I.gc(31,"translate"),I.Tb(),I.Tb(),I.Rb(),I.Tb()),2&e&&(I.Db(2),I.Cc(" ",I.hc(3,10,null!=t.message&&t.message.id?"settings.messages.template.edit.pageTitle":"settings.messages.template.new.pageTitle")," "),I.Db(3),I.Bc(null==t.message?null:t.message.title),I.Db(2),I.lc("formGroup",t.form),I.Db(4),I.Bc(I.hc(12,12,"settings.messages.edit.input.title")),I.Db(6),I.Bc(I.hc(18,14,"settings.messages.edit.input.slug")),I.Db(6),I.Bc(I.hc(24,16,"settings.messages.edit.input.description")),I.Db(4),I.lc("label",I.hc(28,18,"settings.messages.edit.input.text"))("height",300),I.Db(2),I.lc("disabled",t.form.invalid),I.Db(1),I.Bc(I.hc(31,20,"settings.messages.edit.saveBtn")))},directives:[S.a,a.s,a.m,a.g,r.c,r.f,a.c,o.b,a.l,a.e,A.a,n.b],pipes:[l.c],encapsulation:2}),e})(),U=(()=>{class e{constructor(e,t,s,i){this.router=e,this.route=t,this.uiFacade=s,this.settingApiService=i,this.destroy$=new T.a,this.form=new a.f({text:new a.d("")})}ngOnInit(){this.route.paramMap.pipe(Object(h.a)(e=>this.settingApiService.getMessage(e.get("slug"))),Object(f.a)(()=>this.inRequest=!1),Object(v.a)(this.destroy$)).subscribe(e=>{this.message=e,this.form.patchValue({text:e.text})},e=>this.uiFacade.addErrorNotification(e.message))}save(){const e=this.form.get("text").value;this.settingApiService.updateMessage(this.message.id,e).subscribe(e=>{this.router.navigateByUrl("/settings/messages"),this.uiFacade.addInfoNotification(e.message)},e=>this.uiFacade.addErrorNotification(e.message))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(t){return new(t||e)(I.Ob(p.f),I.Ob(p.a),I.Ob(D.f),I.Ob(O.e))},e.\u0275cmp=I.Ib({type:e,selectors:[["app-setting-message-edit"]],decls:18,vars:17,consts:[["header",""],["content",""],[1,"form",3,"formGroup","ngSubmit"],[3,"innerHTML"],[1,"form-group"],["formControlName","text",3,"label","height"],["mat-raised-button","","color","primary",3,"disabled"]],template:function(e,t){1&e&&(I.Ub(0,"app-page-content"),I.Sb(1,0),I.Ac(2),I.gc(3,"translate"),I.Ub(4,"i"),I.Ac(5),I.Tb(),I.Rb(),I.Sb(6,1),I.Ub(7,"form",2),I.bc("ngSubmit",function(){return t.save()}),I.Ub(8,"h3"),I.Ac(9),I.gc(10,"translate"),I.Tb(),I.Pb(11,"p",3),I.Ub(12,"div",4),I.Pb(13,"app-format-editor",5),I.gc(14,"translate"),I.Tb(),I.Ub(15,"button",6),I.Ac(16),I.gc(17,"translate"),I.Tb(),I.Tb(),I.Rb(),I.Tb()),2&e&&(I.Db(2),I.Cc(" ",I.hc(3,9,"settings.messages.edit.pageTitle")," "),I.Db(3),I.Bc(null==t.message?null:t.message.slug),I.Db(2),I.lc("formGroup",t.form),I.Db(2),I.Bc(I.hc(10,11,"settings.messages.edit.input.description")),I.Db(2),I.lc("innerHTML",null==t.message?null:t.message.description,I.tc),I.Db(2),I.lc("label",I.hc(14,13,"settings.messages.edit.input.text"))("height",300),I.Db(2),I.lc("disabled",t.form.invalid),I.Db(1),I.Bc(I.hc(17,15,"settings.messages.edit.saveBtn")))},directives:[S.a,a.s,a.m,a.g,A.a,a.l,a.e,n.b],pipes:[l.c],encapsulation:2}),e})();var N=s("zp1y"),R=s("pLZG"),F=s("vkgz"),w=s("sKXY");const E=[{name:"title",nameI18n:"settings.messages.table.title",type:w.g.STRING,allowedForRoles:[D.d.SUPER_ADMIN,D.d.ADMIN]},{name:"slug",nameI18n:"settings.messages.table.slug",type:w.g.STRING,allowedForRoles:[D.d.SUPER_ADMIN,D.d.ADMIN]},{name:"info",nameI18n:"table.action.info",type:w.g.STRING,actionData:{link:e=>`/settings/messages/${null==e?void 0:e.slug}/edit`,actionType:w.f.LINK,eventType:w.e.EDIT},allowedForRoles:[D.d.SUPER_ADMIN,D.d.ADMIN]},{name:"edit",nameI18n:"table.action.edit",type:w.g.STRING,actionData:{icon:"backup_table",link:e=>`/settings/messages/template/${null==e?void 0:e.id}/edit`,actionType:w.f.LINK,eventType:w.e.EDIT},allowedForRoles:[D.d.SUPER_ADMIN]}];var x=s("7FcC");function j(e,t){1&e&&(I.Sb(0,3),I.Ub(1,"a",4),I.Ub(2,"mat-icon"),I.Ac(3,"add"),I.Tb(),I.Ub(4,"span"),I.Ac(5),I.gc(6,"translate"),I.Tb(),I.Tb(),I.Rb()),2&e&&(I.Db(5),I.Bc(I.hc(6,1,"settings.messages.tableHeader.addBtn")))}const L=[{path:"",component:(()=>{class e{constructor(e,t,s,i){this.adminFacade=e,this.uiFacade=t,this.confirmModalService=s,this.settingApiService=i,this.messages=[],this.tableColumns=E,this.EUserRoleDto=D.d,this.destroy$=new T.a}ngOnInit(){this.initFilterFields()}getSettingMessageList(e=this.requestApiQuery){this.requestApiQuery=e,this.inRequest=!0,this.settingApiService.getMessageList(e).pipe(Object(N.a)(this.adminFacade.admin$),Object(f.a)(()=>this.inRequest=!1),Object(v.a)(this.destroy$)).subscribe(([e,t])=>{this.messages=e.data,this.paginator={length:e.total,page:e.currentPage,pageSize:e.pageSize}},e=>{this.uiFacade.addErrorNotification(e.message)})}setEventData(e){e.event===w.e.DELETE&&this.deleteMessage(e.data)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}deleteMessage(e){this.confirmModalService.openDialog({titleI18n:"confirm.deleteModal.title",titleKeyI18n:e.slug,messageI18n:"confirm.deleteModal.message",messageKeyI18n:`${e.slug} (${e.title})`,confirmBtn:!0,cancelBtn:!0}).pipe(Object(R.a)(e=>e),Object(F.a)(()=>this.inRequest=!0),Object(h.a)(()=>this.settingApiService.deleteMessageTemplate(e.id)),Object(f.a)(()=>this.inRequest=!1),Object(v.a)(this.destroy$)).subscribe(()=>{this.messages=this.messages.filter(t=>t.id!==e.id),this.getSettingMessageList()},e=>{this.uiFacade.addErrorNotification(e.message)})}initFilterFields(){this.filterFields=[{labelI18n:"settings.messages.table.title",name:"title"}]}}return e.\u0275fac=function(t){return new(t||e)(I.Ob(D.a),I.Ob(D.f),I.Ob(g.b),I.Ob(O.e))},e.\u0275cmp=I.Ib({type:e,selectors:[["app-setting-messages"]],decls:6,vars:11,consts:[[3,"tableColumns","inRequest","items","filterFields","paginator","getList","eventData"],["table-title",""],["table-actions","",4,"ngIf"],["table-actions",""],["mat-raised-button","","color","primary","disableRipple","true","routerLink","/settings/messages/template/new",1,"nav-link"]],template:function(e,t){if(1&e&&(I.Ub(0,"app-page-content-table",0),I.bc("getList",function(e){return t.getSettingMessageList(e)})("eventData",function(e){return t.setEventData(e)}),I.Sb(1,1),I.Ac(2),I.gc(3,"translate"),I.Rb(),I.zc(4,j,7,3,"ng-container",2),I.gc(5,"async"),I.Tb()),2&e){let e=null;I.lc("tableColumns",t.tableColumns)("inRequest",t.inRequest)("items",t.messages)("filterFields",t.filterFields)("paginator",t.paginator),I.Db(2),I.Cc(" ",I.hc(3,7,"settings.messages.tableHeader.title")," "),I.Db(2),I.lc("ngIf",(null==(e=I.hc(5,9,t.adminFacade.admin$))?null:e.role)===t.EUserRoleDto.SUPER_ADMIN)}},directives:[x.a,i.l,n.a,p.g,c.a],pipes:[l.c,i.b],encapsulation:2}),e})()},{path:":slug/edit",component:U},{path:"template/new",component:M,canActivate:[u.b]},{path:"template/:id/edit",component:M,canActivate:[u.b]}];let $=(()=>{class e{}return e.\u0275mod=I.Mb({type:e}),e.\u0275inj=I.Lb({factory:function(t){return new(t||e)},imports:[[p.h.forChild(L)],p.h]}),e})(),B=(()=>{class e{}return e.\u0275mod=I.Mb({type:e}),e.\u0275inj=I.Lb({factory:function(t){return new(t||e)},imports:[[i.c,c.b,n.c,r.e,o.c,l.b,a.q,b.a,g.a,d.a,m.a,$]]}),e})()}}]);