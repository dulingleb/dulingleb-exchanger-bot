(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{iD7u:function(e,t,s){"use strict";s.r(t),s.d(t,"UsersModule",function(){return C});var r=s("ofXK"),n=s("sYmb"),a=s("NFeN"),i=s("bTqV"),o=s("kmnG"),b=s("1jcm"),c=s("qFsG"),l=s("3Pt+"),u=s("4evo"),m=s("ULOc"),d=s("ir1t"),p=s("tyNb"),h=s("5+tZ"),f=s("nYR2"),g=s("1G5W"),U=s("XNiG"),T=s("i/bw"),D=s("fXoL"),v=s("FwLO"),A=s("Pfez"),I=s("Kbm1");let y=(()=>{class e{constructor(e,t,s,r){this.router=e,this.route=t,this.uiFacade=s,this.telegramUserApiService=r,this.errors={},this.destroy$=new U.a,this.form=new l.f({discount:new l.d("",[l.r.min(0),l.r.max(100)]),comment:new l.d(""),ban:new l.d("")})}ngOnInit(){this.route.paramMap.pipe(Object(h.a)(e=>this.telegramUserApiService.getUser(+e.get("id"))),Object(f.a)(()=>this.inRequest=!1),Object(g.a)(this.destroy$)).subscribe(e=>{this.user=e,this.form.patchValue({discount:e.discount,comment:e.comment,ban:e.ban})},e=>this.uiFacade.addErrorNotification(e.message))}save(){this.inRequest=!0;const e=this.form.get("discount").value,t=this.form.get("comment").value,s=this.form.get("ban").value;this.telegramUserApiService.updateUser({id:this.user.id,discount:e,comment:t,ban:s}).pipe(Object(f.a)(()=>this.inRequest=!1),Object(g.a)(this.destroy$)).subscribe(e=>this.router.navigateByUrl("/users"),e=>this.showError(e))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}showError(e){var t;this.inRequest=!1,this.errors=(null==e?void 0:e.errors)||{};for(const s of Object.keys(this.errors))null===(t=this.form.get(s))||void 0===t||t.setErrors({valid:!1});this.uiFacade.addErrorNotification(e.message)}}return e.\u0275fac=function(t){return new(t||e)(D.Ob(p.f),D.Ob(p.a),D.Ob(T.f),D.Ob(v.f))},e.\u0275cmp=D.Ib({type:e,selectors:[["app-user-edit"]],decls:84,vars:52,consts:[["header",""],["content",""],[1,"wrapper"],[1,"info-table-block"],[1,"item"],[1,"title"],[1,"value"],["href",""],[1,"edit-info-block"],[1,"form",3,"formGroup","ngSubmit"],[1,"form-group"],["appearance","fill"],["formControlName","discount","type","number","min","0","max","100","step","0.5","matInput",""],["name","discount",3,"errors"],["formControlName","comment","matInput",""],["name","comment",3,"errors"],["labelPosition","before","color","primary","formControlName","ban"],["mat-raised-button","","color","primary",3,"disabled"]],template:function(e,t){1&e&&(D.Ub(0,"app-page-content"),D.Sb(1,0),D.Ac(2),D.gc(3,"translate"),D.Ub(4,"i"),D.Ac(5),D.Tb(),D.Rb(),D.Sb(6,1),D.Ub(7,"div",2),D.Ub(8,"section",3),D.Ub(9,"div",4),D.Ub(10,"p",5),D.Ac(11),D.gc(12,"translate"),D.Tb(),D.Ub(13,"p",6),D.Ac(14),D.Tb(),D.Tb(),D.Ub(15,"div",4),D.Ub(16,"p",5),D.Ac(17),D.gc(18,"translate"),D.Tb(),D.Ub(19,"p",6),D.Ac(20),D.Tb(),D.Tb(),D.Ub(21,"div",4),D.Ub(22,"p",5),D.Ac(23),D.gc(24,"translate"),D.Tb(),D.Ub(25,"p",6),D.Ac(26),D.Tb(),D.Tb(),D.Ub(27,"div",4),D.Ub(28,"p",5),D.Ac(29),D.gc(30,"translate"),D.Tb(),D.Ub(31,"p",6),D.Ub(32,"a",7),D.Ac(33),D.Tb(),D.Tb(),D.Tb(),D.Ub(34,"div",4),D.Ub(35,"p",5),D.Ac(36),D.gc(37,"translate"),D.Tb(),D.Ub(38,"p",6),D.Ac(39),D.Tb(),D.Tb(),D.Ub(40,"div",4),D.Ub(41,"p",5),D.Ac(42),D.gc(43,"translate"),D.Tb(),D.Ub(44,"p",6),D.Ac(45),D.Tb(),D.Tb(),D.Ub(46,"div",4),D.Ub(47,"p",5),D.Ac(48),D.gc(49,"translate"),D.Tb(),D.Ub(50,"p",6),D.Ac(51),D.Tb(),D.Tb(),D.Ub(52,"div",4),D.Ub(53,"p",5),D.Ac(54),D.gc(55,"translate"),D.Tb(),D.Ub(56,"p",6),D.Ac(57),D.Tb(),D.Tb(),D.Tb(),D.Ub(58,"div",8),D.Ub(59,"form",9),D.bc("ngSubmit",function(){return t.save()}),D.Ub(60,"div",10),D.Ub(61,"mat-form-field",11),D.Ub(62,"mat-label"),D.Ac(63),D.gc(64,"translate"),D.Tb(),D.Pb(65,"input",12),D.Ub(66,"mat-error"),D.Pb(67,"app-input-error",13),D.Tb(),D.Tb(),D.Tb(),D.Ub(68,"div",10),D.Ub(69,"mat-form-field",11),D.Ub(70,"mat-label"),D.Ac(71),D.gc(72,"translate"),D.Tb(),D.Pb(73,"textarea",14),D.Ub(74,"mat-error"),D.Pb(75,"app-input-error",15),D.Tb(),D.Tb(),D.Tb(),D.Ub(76,"div",10),D.Ub(77,"mat-slide-toggle",16),D.Ub(78,"mat-label"),D.Ac(79),D.gc(80,"translate"),D.Tb(),D.Tb(),D.Tb(),D.Ub(81,"button",17),D.Ac(82),D.gc(83,"translate"),D.Tb(),D.Tb(),D.Tb(),D.Tb(),D.Rb(),D.Tb()),2&e&&(D.Db(2),D.Cc(" ",D.hc(3,26,"user.edit.pageTitle")," "),D.Db(3),D.Bc(null==t.user?null:t.user.username),D.Db(6),D.Bc(D.hc(12,28,"user.info.id")),D.Db(3),D.Bc(null==t.user?null:t.user.id),D.Db(3),D.Bc(D.hc(18,30,"user.info.username")),D.Db(3),D.Bc(null==t.user?null:t.user.username),D.Db(3),D.Bc(D.hc(24,32,"user.info.name")),D.Db(3),D.Bc(((null==t.user?null:t.user.firstName)||"")+" "+((null==t.user?null:t.user.lastName)||"")),D.Db(3),D.Bc(D.hc(30,34,"user.info.operationsCount")),D.Db(4),D.Bc(null==t.user?null:t.user.operationsCount),D.Db(3),D.Bc(D.hc(37,36,"user.info.operationsSum")),D.Db(3),D.Bc(null==t.user?null:t.user.operationsSum),D.Db(3),D.Bc(D.hc(43,38,"user.info.ref")),D.Db(3),D.Bc(null==t.user?null:t.user.operationsSum),D.Db(3),D.Bc(D.hc(49,40,"user.info.operationsRef")),D.Db(3),D.Bc(null==t.user?null:t.user.operationsSum),D.Db(3),D.Bc(D.hc(55,42,"user.info.operationsREfSum")),D.Db(3),D.Bc(null==t.user?null:t.user.operationsSum),D.Db(2),D.lc("formGroup",t.form),D.Db(4),D.Bc(D.hc(64,44,"user.edit.input.discount")),D.Db(4),D.lc("errors",t.errors),D.Db(4),D.Bc(D.hc(72,46,"user.edit.input.comment")),D.Db(4),D.lc("errors",t.errors),D.Db(4),D.Bc(D.hc(80,48,"user.edit.input.ban")),D.Db(2),D.lc("disabled",t.form.invalid||t.inRequest),D.Db(1),D.Bc(D.hc(83,50,"user.edit.save")))},directives:[A.a,l.s,l.m,l.g,o.c,o.f,l.c,l.p,c.b,l.l,l.e,o.b,I.a,b.a,i.b],pipes:[n.c],styles:[".wrapper[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);grid-column-gap:1.5rem}"]}),e})();var R=s("zp1y"),N=s("uhkJ"),S=s("sKXY");const w=[{name:"username",nameI18n:"users.table.username",type:S.g.STRING,sort:!0,allowedForRoles:[T.d.SUPER_ADMIN,T.d.ADMIN]},{name:"operationsCount",nameI18n:"users.table.operationsCount",type:S.g.STRING,sort:!0,allowedForRoles:[T.d.SUPER_ADMIN,T.d.ADMIN]},{name:"operationsSum",nameI18n:"users.table.operationsSum",type:S.g.STRING,sort:!0,allowedForRoles:[T.d.SUPER_ADMIN,T.d.ADMIN]},{name:"discount",nameI18n:"users.table.discount",type:S.g.STRING,sort:!0,allowedForRoles:[T.d.SUPER_ADMIN,T.d.ADMIN]},{name:"ban",nameI18n:"users.table.ban",type:S.g.STRING,icon:e=>e.ban?"clear":"done",class:e=>e.ban?"text-warn":"text-accent",allowedForRoles:[T.d.SUPER_ADMIN,T.d.ADMIN]},{name:"edit",nameI18n:"table.action.edit",type:S.g.STRING,actionData:{link:e=>`/users/${e.id}/edit`,actionType:S.f.LINK,eventType:S.e.EDIT},allowedForRoles:[T.d.SUPER_ADMIN,T.d.ADMIN]}];var F=s("7FcC");const O=[{path:"",component:(()=>{class e{constructor(e,t,s){this.adminFacade=e,this.uiFacade=t,this.adminApiService=s,this.users=[],this.tableColumns=w,this.destroy$=new U.a}ngOnInit(){this.initFilterFields()}getAdminList(e){this.inRequest=!0,this.adminApiService.getList(e).pipe(Object(R.a)(this.adminFacade.admin$),Object(f.a)(()=>this.inRequest=!1),Object(g.a)(this.destroy$)).subscribe(([e,t])=>{this.users=e.data,this.paginator={length:e.total,page:e.currentPage,pageSize:e.pageSize}},e=>this.uiFacade.addErrorNotification(e.message))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initFilterFields(){this.filterFields=[{labelI18n:"users.table.username",name:"username",type:N.a.INPUT},{labelI18n:"users.table.discount",name:"discount",type:N.a.INPUT},{labelI18n:"users.table.ban",name:"ban",type:N.a.SELECT,options:[{value:!1,titleI18n:"user.ban.0",class:"text-accent"},{value:!0,titleI18n:"user.ban.1",class:"text-warn"}]}]}}return e.\u0275fac=function(t){return new(t||e)(D.Ob(T.a),D.Ob(T.f),D.Ob(v.f))},e.\u0275cmp=D.Ib({type:e,selectors:[["app-users"]],decls:4,vars:8,consts:[[3,"tableColumns","inRequest","items","filterFields","paginator","getList"],["table-title",""]],template:function(e,t){1&e&&(D.Ub(0,"app-page-content-table",0),D.bc("getList",function(e){return t.getAdminList(e)}),D.Sb(1,1),D.Ac(2),D.gc(3,"translate"),D.Rb(),D.Tb()),2&e&&(D.lc("tableColumns",t.tableColumns)("inRequest",t.inRequest)("items",t.users)("filterFields",t.filterFields)("paginator",t.paginator),D.Db(2),D.Cc(" ",D.hc(3,6,"users.tableHeader.title")," "))},directives:[F.a],pipes:[n.c],encapsulation:2}),e})()},{path:":id/edit",component:y}];let B=(()=>{class e{}return e.\u0275mod=D.Mb({type:e}),e.\u0275inj=D.Lb({factory:function(t){return new(t||e)},imports:[[p.i.forChild(O)],p.i]}),e})(),C=(()=>{class e{}return e.\u0275mod=D.Mb({type:e}),e.\u0275inj=D.Lb({factory:function(t){return new(t||e)},imports:[[r.c,n.b,l.q,a.b,i.c,b.b,o.e,c.c,m.a,u.a,B,d.a]]}),e})()}}]);