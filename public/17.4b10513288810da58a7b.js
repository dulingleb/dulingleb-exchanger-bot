(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{EbGA:function(e,t,s){"use strict";s.r(t),s.d(t,"SettingsMessagesModule",function(){return P});var i=s("ofXK"),a=s("3Pt+"),r=s("bTqV"),n=s("kmnG"),o=s("NFeN"),l=s("qFsG"),c=s("sYmb"),b=s("ir1t"),g=s("+dTB"),m=s("xoVn"),d=s("ULOc"),p=s("4evo"),u=s("tyNb"),h=s("yK//"),f=s("5+tZ"),v=s("1G5W"),T=s("XNiG"),y=s("LRne"),D=s("i/bw"),R=s("fXoL"),O=s("FwLO"),I=s("Pfez"),U=s("Kbm1"),w=s("KVI4");let S=(()=>{class e{constructor(e,t,s,i){this.router=e,this.route=t,this.uiFacade=s,this.settingApiService=i,this.errors={},this.destroy$=new T.a,this.form=new a.f({title:new a.d(""),slug:new a.d(""),description:new a.d(""),text:new a.d("")})}ngOnInit(){this.inRequest=!0,this.route.paramMap.pipe(Object(f.a)(e=>{const t=+e.get("id");return t?this.settingApiService.getMessageTemplate(t):Object(y.a)({})}),Object(v.a)(this.destroy$)).subscribe(e=>{this.inRequest=!1,this.message=e,this.form.patchValue({title:e.title,slug:e.slug,description:e.description,text:e.text})},e=>this.showError(e))}save(){const e=this.form.get("title").value,t=this.form.get("slug").value,s=this.form.get("description").value,i=this.form.get("text").value,a=Object.assign(Object.assign({},this.message),{title:e,slug:t,description:s,text:i});this.message.id?this.updateMessageTemplate(a):this.addMessageTemplate(a)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}addMessageTemplate(e){this.inRequest=!0,this.settingApiService.addMessageTemplate(e).subscribe(e=>{this.router.navigateByUrl("/settings/messages"),this.uiFacade.addInfoNotification(e.message)},e=>this.showError(e))}updateMessageTemplate(e){this.inRequest=!0,this.settingApiService.updateMessageTemplate(e).subscribe(e=>{this.router.navigateByUrl("/settings/messages"),this.uiFacade.addInfoNotification(e.message)},e=>this.showError(e))}showError(e){var t;this.inRequest=!1,this.errors=(null==e?void 0:e.errors)||{};for(const s of Object.keys(this.errors))null===(t=this.form.get(s))||void 0===t||t.setErrors({valid:!1});this.uiFacade.addErrorNotification(e.message)}}return e.\u0275fac=function(t){return new(t||e)(R.Ob(u.f),R.Ob(u.a),R.Ob(D.f),R.Ob(O.e))},e.\u0275cmp=R.Ib({type:e,selectors:[["app-setting-message-template-edit"]],decls:38,vars:25,consts:[["header",""],["content",""],[1,"form",3,"formGroup","ngSubmit"],[1,"form-group"],["appearance","fill"],["formControlName","title","type","text","matInput",""],["name","title",3,"errors"],["formControlName","slug","type","text","matInput",""],["name","slug",3,"errors"],["formControlName","description","matInput",""],["name","description",3,"errors"],["formControlName","text",3,"label","height"],["mat-raised-button","","color","primary",3,"disabled"]],template:function(e,t){1&e&&(R.Ub(0,"app-page-content"),R.Sb(1,0),R.Ac(2),R.gc(3,"translate"),R.Ub(4,"i"),R.Ac(5),R.Tb(),R.Rb(),R.Sb(6,1),R.Ub(7,"form",2),R.bc("ngSubmit",function(){return t.save()}),R.Ub(8,"div",3),R.Ub(9,"mat-form-field",4),R.Ub(10,"mat-label"),R.Ac(11),R.gc(12,"translate"),R.Tb(),R.Pb(13,"input",5),R.Ub(14,"mat-error"),R.Pb(15,"app-input-error",6),R.Tb(),R.Tb(),R.Tb(),R.Ub(16,"div",3),R.Ub(17,"mat-form-field",4),R.Ub(18,"mat-label"),R.Ac(19),R.gc(20,"translate"),R.Tb(),R.Pb(21,"input",7),R.Ub(22,"mat-error"),R.Pb(23,"app-input-error",8),R.Tb(),R.Tb(),R.Tb(),R.Ub(24,"div",3),R.Ub(25,"mat-form-field",4),R.Ub(26,"mat-label"),R.Ac(27),R.gc(28,"translate"),R.Tb(),R.Pb(29,"textarea",9),R.Ub(30,"mat-error"),R.Pb(31,"app-input-error",10),R.Tb(),R.Tb(),R.Tb(),R.Ub(32,"div",3),R.Pb(33,"app-format-editor",11),R.gc(34,"translate"),R.Tb(),R.Ub(35,"button",12),R.Ac(36),R.gc(37,"translate"),R.Tb(),R.Tb(),R.Rb(),R.Tb()),2&e&&(R.Db(2),R.Cc(" ",R.hc(3,13,null!=t.message&&t.message.id?"settings.messages.template.edit.pageTitle":"settings.messages.template.new.pageTitle")," "),R.Db(3),R.Bc(null==t.message?null:t.message.title),R.Db(2),R.lc("formGroup",t.form),R.Db(4),R.Bc(R.hc(12,15,"settings.messages.edit.input.title")),R.Db(4),R.lc("errors",t.errors),R.Db(4),R.Bc(R.hc(20,17,"settings.messages.edit.input.slug")),R.Db(4),R.lc("errors",t.errors),R.Db(4),R.Bc(R.hc(28,19,"settings.messages.edit.input.description")),R.Db(4),R.lc("errors",t.errors),R.Db(2),R.lc("label",R.hc(34,21,"settings.messages.edit.input.text"))("height",300),R.Db(2),R.lc("disabled",t.form.invalid||t.inRequest),R.Db(1),R.Bc(R.hc(37,23,"settings.messages.edit.saveBtn")))},directives:[I.a,a.s,a.m,a.g,n.c,n.f,a.c,l.b,a.l,a.e,n.b,U.a,w.a,r.b],pipes:[c.c],encapsulation:2}),e})();var A=s("nYR2");let M=(()=>{class e{constructor(e,t,s,i){this.router=e,this.route=t,this.uiFacade=s,this.settingApiService=i,this.errors={},this.destroy$=new T.a,this.form=new a.f({text:new a.d("")})}ngOnInit(){this.inRequest=!0,this.route.paramMap.pipe(Object(f.a)(e=>this.settingApiService.getMessage(e.get("slug")).pipe(Object(A.a)(()=>this.inRequest=!1),Object(v.a)(this.destroy$))),Object(v.a)(this.destroy$)).subscribe(e=>{this.message=e,this.form.patchValue({text:e.text})},e=>this.showError(e))}save(){this.inRequest=!0;const e=this.form.get("text").value;this.settingApiService.updateMessage(this.message.id,e).pipe(Object(A.a)(()=>this.inRequest=!1),Object(v.a)(this.destroy$)).subscribe(e=>{this.router.navigateByUrl("/settings/messages"),this.uiFacade.addInfoNotification(e.message)},e=>this.showError(e))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}showError(e){var t;this.inRequest=!1,this.errors=(null==e?void 0:e.errors)||{};for(const s of Object.keys(this.errors))null===(t=this.form.get(s))||void 0===t||t.setErrors({valid:!1});this.uiFacade.addErrorNotification(e.message)}}return e.\u0275fac=function(t){return new(t||e)(R.Ob(u.f),R.Ob(u.a),R.Ob(D.f),R.Ob(O.e))},e.\u0275cmp=R.Ib({type:e,selectors:[["app-setting-message-edit"]],decls:20,vars:18,consts:[["header",""],["content",""],[1,"form",3,"formGroup","ngSubmit"],[3,"innerHTML"],[1,"form-group"],["formControlName","text",3,"label","height"],["name","text",3,"errors"],["mat-raised-button","","color","primary",3,"disabled"]],template:function(e,t){1&e&&(R.Ub(0,"app-page-content"),R.Sb(1,0),R.Ac(2),R.gc(3,"translate"),R.Ub(4,"i"),R.Ac(5),R.Tb(),R.Rb(),R.Sb(6,1),R.Ub(7,"form",2),R.bc("ngSubmit",function(){return t.save()}),R.Ub(8,"h3"),R.Ac(9),R.gc(10,"translate"),R.Tb(),R.Pb(11,"p",3),R.Ub(12,"div",4),R.Pb(13,"app-format-editor",5),R.gc(14,"translate"),R.Ub(15,"mat-error"),R.Pb(16,"app-input-error",6),R.Tb(),R.Tb(),R.Ub(17,"button",7),R.Ac(18),R.gc(19,"translate"),R.Tb(),R.Tb(),R.Rb(),R.Tb()),2&e&&(R.Db(2),R.Cc(" ",R.hc(3,10,"settings.messages.edit.pageTitle")," "),R.Db(3),R.Bc(null==t.message?null:t.message.slug),R.Db(2),R.lc("formGroup",t.form),R.Db(2),R.Bc(R.hc(10,12,"settings.messages.edit.input.description")),R.Db(2),R.lc("innerHTML",null==t.message?null:t.message.description,R.tc),R.Db(2),R.lc("label",R.hc(14,14,"settings.messages.edit.input.text"))("height",300),R.Db(3),R.lc("errors",t.errors),R.Db(1),R.lc("disabled",t.form.invalid||t.inRequest),R.Db(1),R.Bc(R.hc(19,16,"settings.messages.edit.saveBtn")))},directives:[I.a,a.s,a.m,a.g,w.a,a.l,a.e,n.b,U.a,r.b],pipes:[c.c],encapsulation:2}),e})();var N=s("zp1y"),F=s("pLZG"),E=s("vkgz"),q=s("sKXY");const j=[{name:"title",nameI18n:"settings.messages.table.title",type:q.g.STRING,allowedForRoles:[D.d.SUPER_ADMIN,D.d.ADMIN]},{name:"slug",nameI18n:"settings.messages.table.slug",type:q.g.STRING,allowedForRoles:[D.d.SUPER_ADMIN,D.d.ADMIN]},{name:"info",nameI18n:"table.action.info",type:q.g.STRING,actionData:{link:e=>`/settings/messages/${null==e?void 0:e.slug}/edit`,actionType:q.f.LINK,eventType:q.e.EDIT},allowedForRoles:[D.d.SUPER_ADMIN,D.d.ADMIN]},{name:"edit",nameI18n:"table.action.edit",type:q.g.STRING,actionData:{icon:"backup_table",link:e=>`/settings/messages/template/${null==e?void 0:e.id}/edit`,actionType:q.f.LINK,eventType:q.e.EDIT},allowedForRoles:[D.d.SUPER_ADMIN]}];var x=s("7FcC");function $(e,t){1&e&&(R.Sb(0,3),R.Ub(1,"a",4),R.Ub(2,"mat-icon"),R.Ac(3,"add"),R.Tb(),R.Ub(4,"span"),R.Ac(5),R.gc(6,"translate"),R.Tb(),R.Tb(),R.Rb()),2&e&&(R.Db(5),R.Bc(R.hc(6,1,"settings.messages.tableHeader.addBtn")))}const L=[{path:"",component:(()=>{class e{constructor(e,t,s,i){this.adminFacade=e,this.uiFacade=t,this.confirmModalService=s,this.settingApiService=i,this.messages=[],this.tableColumns=j,this.EUserRoleDto=D.d,this.destroy$=new T.a}ngOnInit(){this.initFilterFields()}getSettingMessageList(e=this.requestApiQuery){this.requestApiQuery=e,this.inRequest=!0,this.settingApiService.getMessageList(e).pipe(Object(N.a)(this.adminFacade.admin$),Object(A.a)(()=>this.inRequest=!1),Object(v.a)(this.destroy$)).subscribe(([e,t])=>{this.messages=e.data,this.paginator={length:e.total,page:e.currentPage,pageSize:e.pageSize}},e=>{this.uiFacade.addErrorNotification(e.message)})}setEventData(e){e.event===q.e.DELETE&&this.deleteMessage(e.data)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}deleteMessage(e){this.confirmModalService.openDialog({titleI18n:"confirm.deleteModal.title",titleKeyI18n:e.slug,messageI18n:"confirm.deleteModal.message",messageKeyI18n:`${e.slug} (${e.title})`,confirmBtn:!0,cancelBtn:!0}).pipe(Object(F.a)(e=>e),Object(E.a)(()=>this.inRequest=!0),Object(f.a)(()=>this.settingApiService.deleteMessageTemplate(e.id)),Object(A.a)(()=>this.inRequest=!1),Object(v.a)(this.destroy$)).subscribe(()=>{this.messages=this.messages.filter(t=>t.id!==e.id),this.getSettingMessageList()},e=>{this.uiFacade.addErrorNotification(e.message)})}initFilterFields(){this.filterFields=[{labelI18n:"settings.messages.table.title",name:"title"}]}}return e.\u0275fac=function(t){return new(t||e)(R.Ob(D.a),R.Ob(D.f),R.Ob(g.b),R.Ob(O.e))},e.\u0275cmp=R.Ib({type:e,selectors:[["app-setting-messages"]],decls:6,vars:11,consts:[[3,"tableColumns","inRequest","items","filterFields","paginator","getList","eventData"],["table-title",""],["table-actions","",4,"ngIf"],["table-actions",""],["mat-raised-button","","color","primary","disableRipple","true","routerLink","/settings/messages/template/new",1,"nav-link"]],template:function(e,t){if(1&e&&(R.Ub(0,"app-page-content-table",0),R.bc("getList",function(e){return t.getSettingMessageList(e)})("eventData",function(e){return t.setEventData(e)}),R.Sb(1,1),R.Ac(2),R.gc(3,"translate"),R.Rb(),R.zc(4,$,7,3,"ng-container",2),R.gc(5,"async"),R.Tb()),2&e){let e=null;R.lc("tableColumns",t.tableColumns)("inRequest",t.inRequest)("items",t.messages)("filterFields",t.filterFields)("paginator",t.paginator),R.Db(2),R.Cc(" ",R.hc(3,7,"settings.messages.tableHeader.title")," "),R.Db(2),R.lc("ngIf",(null==(e=R.hc(5,9,t.adminFacade.admin$))?null:e.role)===t.EUserRoleDto.SUPER_ADMIN)}},directives:[x.a,i.l,r.a,u.h,o.a],pipes:[c.c,i.b],encapsulation:2}),e})()},{path:":slug/edit",component:M},{path:"template/new",component:S,canActivate:[h.b]},{path:"template/:id/edit",component:S,canActivate:[h.b]}];let B=(()=>{class e{}return e.\u0275mod=R.Mb({type:e}),e.\u0275inj=R.Lb({factory:function(t){return new(t||e)},imports:[[u.i.forChild(L)],u.i]}),e})(),P=(()=>{class e{}return e.\u0275mod=R.Mb({type:e}),e.\u0275inj=R.Lb({factory:function(t){return new(t||e)},imports:[[i.c,o.b,r.c,n.e,l.c,c.b,a.q,b.a,m.a,g.a,d.a,p.a,B]]}),e})()}}]);